<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>VimNote/C/c-macro | OrexZ</title>
  <meta name="author" content="Rex">
  
  <meta name="description" content="embedded linux os article">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="VimNote/C/c-macro"/>
  <meta property="og:site_name" content="OrexZ"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/atom.xml" title="OrexZ" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">  
  <link rel="stylesheet" href="/css/sidenav.css" media="screen" type="text/css">  
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'true']);
_gaq.push(['_trackPageview']);
(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;

ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';

var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>


<meta name="generator" content="Hexo 4.2.0"></head>

<body id="body" data-spy="scroll" data-target=".toc">
  <div class="container" id="container">
	<div class="content">
	  <div class="page-header">		
  <h1><a class="brand" href="/">OrexZ</a><span class="split"></span><span class="title">VimNote/C/c-macro</span><span class="date" id="title-date"><i class="fa fa-clock-o"></i> 2019-11-18</span></h1>
</div>		

<div class="row page">
  <!-- cols -->	
  
  

  
	<div class="col-md-12">
	  

	  <!-- content -->
	  <h1 id="C语言中的宏"><a href="#C语言中的宏" class="headerlink" title="C语言中的宏"></a>C语言中的宏</h1><p>本文主要记录C语言中，与宏相关的奇淫巧技。</p>
<p>需要声明的一点是，本文按照GCC编译器与C99的标准来说明，如果使用其他编译器，<br>定义宏的方式都可能不同。</p>
<h2 id="调试Macro的展开"><a href="#调试Macro的展开" class="headerlink" title="调试Macro的展开"></a>调试Macro的展开</h2><p>有时候，你会奇怪为什么宏没有后按照你设计的那样运行，于是你想要找到一个办法显示宏展开后的状态。</p>
<p>这一节就说明使用GCC编译器如何调试宏的展开。</p>
<p>其实也是很简单的，你只需要在编译的时候只让build过程执行到预处理为止，<br>对于GCC而言，需要这样传递参数：</p>
<pre><code>gcc -E -dD obj.c -o extend.txt</code></pre><p>简单解释下参数：</p>
<blockquote>
<p>-E: 只做预处理<br>-dD: 输出的内容包括你原始定义的宏<br>-o: 输出重定向</p>
</blockquote>
<p>当然，如果你引入了标准库头文件，那么就会有好多的输出内容，请根据你的需要使用关键字过滤就好。</p>
<p>不过需要注意的是，不同的操作系统可能支持不同的编译器，并且不同的编译器支持的参数可能不同，<br>所以如果你得到的不是你想要的内容，请查看你的编译器文档。</p>
<h2 id="宏中的可变参数"><a href="#宏中的可变参数" class="headerlink" title="宏中的可变参数"></a>宏中的可变参数</h2><p>GCC编译器支持宏的可变参数，那么就有两个问题：</p>
<ol>
<li>如何定义(或者说传递)可变参数</li>
<li>如何承接可变参数</li>
</ol>
<p>简单的例子就是：</p>
<pre><code>#define MORE_ARGS(...)  __VA_ARGS__</code></pre><p>看起来简单，不过有一些细节需要注意：</p>
<ol>
<li>可变参数必须放在最后，这与C语言其他可变参数的规则一致</li>
<li>需要知道<strong>VA_ARGS</strong>配合其他的符号都干了什么</li>
</ol>
<p>看个例子：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>小结：</p>
<h2 id="宏中的-‘-’-与-‘-’"><a href="#宏中的-‘-’-与-‘-’" class="headerlink" title="宏中的 ‘#’ 与 ‘##’"></a>宏中的 ‘#’ 与 ‘##’</h2><p>简单的先介绍下这两个符号的相关知识。</p>
<p>‘#’与’##’都是编译器认识的符号，如果你了解一些编译器的知识，<br>你应该知道，所谓语言就是编译器认识的语言而已，它给你提供一些便于记忆的标识，仅此而已。<br>本文提到的这两个符号是预处理阶段解析的。</p>
<blockquote>
<p>‘#’</p>
</blockquote>
<p>使用’#’前缀修饰标识符，可以将标识符的字面意思转化为字符串。</p>
<blockquote>
<p>‘##’</p>
</blockquote>
<p>使用’##’可以将两个标识符合并成一个标识符。<br>需要知道的是，’##’需要两个操作数，不能当前缀或者后缀。<br>不过’##’可以在宏中单独使用，表示如果后面参数没有，去掉前面参数后面的多余的逗号。</p>
<p>看个简单栗子：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* implement part */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TO_STRING(arg) (#arg)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> COMBO_DESCRIPTOR(one, another) (one##another)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* test part */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> ** argv)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> * hello_world;</span><br><span class="line">    <span class="keyword">int</span> _combo;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> * hello_world_combo = <span class="string">"hello combo"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"[#] to string&gt; got: [%s], wanted:[hello_world]\n"</span>,TO_STRING(hello_world) );</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"[##] combine two descriptors into one&gt; got: [%s], wanted:[hello combo]\n"</span>,</span><br><span class="line">            COMBO_DESCRIPTOR(hello_world, _combo));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="comment">#] to string&gt; got: [hello_world], wanted:[hello_world]</span></span><br><span class="line">[<span class="comment">##] combine two descriptors into one&gt; got: [hello combo], wanted:[hello combo]</span></span><br></pre></td></tr></table></figure>

<h3 id="使用’-’与’-’实现动态计算传入宏中的参数个数"><a href="#使用’-’与’-’实现动态计算传入宏中的参数个数" class="headerlink" title="使用’#’与’##’实现动态计算传入宏中的参数个数"></a>使用’#’与’##’实现动态计算传入宏中的参数个数</h3><p>我们在StackOverflow上面看到一个比较有意思的议题，就是如何打印传递的参数个数，进而动态调用不同的函数。</p>
<p><a href="https://stackoverflow.com/questions/2308243/macro-returning-the-number-of-arguments-it-is-given-in-c" target="_blank" rel="noopener">看看这里的讨论</a></p>
<p>先上代码看看它的整体实现：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PP_NARG(...) \</span></span><br><span class="line">    PP_NARG_(__VA_ARGS__,PP_RSEQ_N())</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PP_NARG_(...) \</span></span><br><span class="line">    PP_ARG_N(__VA_ARGS__)</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PP_ARG_N( \</span></span><br><span class="line">     _1, _2, _3, _4, _5, _6, _7, _8, _9,_10, \</span><br><span class="line">    _11,_12,_13,_14,_15,_16,_17,_18,_19,_20, \</span><br><span class="line">    _21,_22,_23,_24,_25,_26,_27,_28,_29,_30, \</span><br><span class="line">    _31,_32,_33,_34,_35,_36,_37,_38,_39,_40, \</span><br><span class="line">    _41,_42,_43,_44,_45,_46,_47,_48,_49,_50, \</span><br><span class="line">    _51,_52,_53,_54,_55,_56,_57,_58,_59,_60, \</span><br><span class="line">    _61,_62,_63,  N, ...) N</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PP_RSEQ_N() \</span></span><br><span class="line">    <span class="number">63</span>,<span class="number">62</span>,<span class="number">61</span>,<span class="number">60</span>,                   \</span><br><span class="line">    <span class="number">59</span>,<span class="number">58</span>,<span class="number">57</span>,<span class="number">56</span>,<span class="number">55</span>,<span class="number">54</span>,<span class="number">53</span>,<span class="number">52</span>,<span class="number">51</span>,<span class="number">50</span>, \</span><br><span class="line">    <span class="number">49</span>,<span class="number">48</span>,<span class="number">47</span>,<span class="number">46</span>,<span class="number">45</span>,<span class="number">44</span>,<span class="number">43</span>,<span class="number">42</span>,<span class="number">41</span>,<span class="number">40</span>, \</span><br><span class="line">    <span class="number">39</span>,<span class="number">38</span>,<span class="number">37</span>,<span class="number">36</span>,<span class="number">35</span>,<span class="number">34</span>,<span class="number">33</span>,<span class="number">32</span>,<span class="number">31</span>,<span class="number">30</span>, \</span><br><span class="line">    <span class="number">29</span>,<span class="number">28</span>,<span class="number">27</span>,<span class="number">26</span>,<span class="number">25</span>,<span class="number">24</span>,<span class="number">23</span>,<span class="number">22</span>,<span class="number">21</span>,<span class="number">20</span>, \</span><br><span class="line">    <span class="number">19</span>,<span class="number">18</span>,<span class="number">17</span>,<span class="number">16</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">10</span>, \</span><br><span class="line">     <span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PRINT(pp_narg)     printf(<span class="meta-string">"%2d = %s\n"</span>, pp_narg, # pp_narg)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> lint</span></span><br><span class="line"><span class="comment">/* Prevent over-aggressive optimizers from eliminating ID string */</span></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">const</span> <span class="keyword">char</span> jlss_id_narg_c[];</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span>  jlss_id_narg_c[] = <span class="string">"@(#)$Id: narg.c,v 1.2 2010/01/24 18:12:05 jleffler Exp $"</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span>  <span class="comment">/* lint */</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> ** argv)</span> </span>&#123;</span><br><span class="line">    PRINT(PP_NARG(A));</span><br><span class="line">    PRINT(PP_NARG(A, B));</span><br><span class="line">    PRINT(PP_NARG(A, B, C));</span><br><span class="line">    PRINT(PP_NARG(A, B, C, D));</span><br><span class="line">    PRINT(PP_NARG(A, B, C, D, E));</span><br><span class="line"></span><br><span class="line">    PRINT(PP_NARG(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment">// 1..10</span></span><br><span class="line">                  <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment">// 11..20</span></span><br><span class="line">                  <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment">// 21..30</span></span><br><span class="line">                  <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment">// 31..40</span></span><br><span class="line">                  <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment">// 41..50</span></span><br><span class="line">                  <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment">// 51..60</span></span><br><span class="line">                  <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    ** If the number of arguments to PP_NARG() is greater than 63, the</span></span><br><span class="line"><span class="comment">    ** 64th argument is returned.  This is well-defined behaviour, but</span></span><br><span class="line"><span class="comment">    ** not exactly what was intended.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    PRINT(PP_NARG(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment">// 1..10</span></span><br><span class="line">                  <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment">// 11..20</span></span><br><span class="line">                  <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment">// 21..30</span></span><br><span class="line">                  <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment">// 31..40</span></span><br><span class="line">                  <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment">// 41..50</span></span><br><span class="line">                  <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment">// 51..60</span></span><br><span class="line">                  <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">-123456789</span>));</span><br><span class="line"></span><br><span class="line">    PRINT(PP_NARG(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment">// 1..10</span></span><br><span class="line">                  <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment">// 11..20</span></span><br><span class="line">                  <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment">// 21..30</span></span><br><span class="line">                  <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment">// 31..40</span></span><br><span class="line">                  <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment">// 41..50</span></span><br><span class="line">                  <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="comment">// 51..60</span></span><br><span class="line">                  <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">-123456789</span>, <span class="number">-987654321</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>看看输出：</p>
<pre><code>1 = PP_NARG(A)
2 = PP_NARG(A, B)
3 = PP_NARG(A, B, C)
4 = PP_NARG(A, B, C, D)
5 = PP_NARG(A, B, C, D, E)
63 = PP_NARG(1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3)
-123456789 = PP_NARG(1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, -123456789)
-123456789 = PP_NARG(1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, -123456789, -987654321)</code></pre><p>我们解释下这个程序的巧妙之处：</p>
<ol>
<li>PRINT &gt; 这个宏看起来就很简单，完成两个目的，一个是打印传入的参数个数，另一个是将参数字面意思转成字符串然后显示出来。</li>
<li>PP_RSEQ_N &gt; 这个宏表示支持的最大的记录参数个数的值，注意它的顺序是倒过来的，为什么呢？因为它会从后往前’吃’，就是这样。</li>
<li></li>
</ol>
<h2 id="编译器提供的常用宏-GCC"><a href="#编译器提供的常用宏-GCC" class="headerlink" title="编译器提供的常用宏(GCC)"></a>编译器提供的常用宏(GCC)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">__func__    表示当前宏所在的函数名称字符串</span><br><span class="line">__LINE__    表示当前宏所在的源文件中的行数</span><br><span class="line">__FILE__    表示宏所在源文件的名字</span><br><span class="line">__DATE__    编译的日期（格式&quot;Mmm dd yyyy&quot;）</span><br><span class="line">__TIME__    编译的时间（格式&quot;hh:mm:ss&quot;）</span><br><span class="line">__STDC__    如果编译器接受标准C，那么值为1</span><br></pre></td></tr></table></figure>


	  

	  <div>
  		<center>
		  <div class="pagination">
<ul class="pagination">
	
	
	
	
	
	
		
	
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
			
		
	
		
			
			
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
	
	
		<li class="prev"><a href="/2019/11/18/VimNote/C/c-strange/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>prev</a></li>
	
	<li><a href="/"><i class="fa fa-archive"></i>Home</a></li>
	
		<li class="next"><a href="/2019/10/13/%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/" class="alignright next">next<i class="fa fa-arrow-circle-o-right"></i></a></li>
	
</ul>
</div>

		</center>
	  </div>
	  
	</div> <!-- col-md-9/col-md-12 -->
	
  </div><!-- row -->

	</div>
  </div>
  <div class="container-narrow">
	<footer> <p>
  &copy; 2020 Rex
  
      with help from <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-wixo/" target="_blank" rel="noopener">Wixo</a>.    
</p> </footer>
  </div> <!-- container-narrow -->
  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/jquery.tableofcontents.min.js"></script>
<script src="/js/tocgenerator.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>


</body>
</html>
